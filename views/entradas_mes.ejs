<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Entradas do Mês</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body class="container mt-4">

    <style>
        /* Ocultar botões e links ao imprimir */
@media print {
    .no-print {
        display: none;
    }
}
    </style>
    <style>
  #btnTopo {
    display: none;
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 999;
    width: 50px;
    height: 50px;
    font-size: 22px;
    align-items: center;
    justify-content: center;
  }
</style>

  <h2 class="mb-4">Entradas do Mês</h2>

  <form method="get" action="/entradas-mes" class="row g-2 mb-3">

  <div class="position-relative mb-3 no-print">
  <i class="bi bi-search position-absolute top-50 start-0 translate-middle-y ms-2 text-muted"></i>
  <input type="text" class="form-control form-control-sm ps-5" id="searchInput"     placeholder="Buscar por Nome ou RA..." style="border: 1px solid rgb(0, 255, 0);">
</div>
</form>

  <% if (entradas.length === 0) { %>
    <div class="alert alert-info">Nenhuma entrada registrada neste mês.</div>
  <% } else { %>
    <table class="table table-bordered table-sm" id="tabela-entradas">
      <thead>
        <tr>
          <th>Nome</th>
          <th>RA</th>
          <th>Data</th>
          <th>Hora</th>
          <th>Justificativa</th>
          <th>tel_responsavel_1</th>
          <th>tel_responsavel_2</th>
        
        </tr>
      </thead>
      <tbody>
        <% entradas.forEach(entrada => { %>
          <tr>
            <td><%= entrada.nome ? String(entrada.nome).toUpperCase() : '-' %></td>
            <td><%= entrada.ra %></td>
            <td><%= new Date(entrada.data_hora).toISOString().split('T')[0] %></td>
            <td><%= new Date(entrada.data_hora).toTimeString().split(' ')[0] %></td>
            <td><%= entrada.justificativa || '-' %></td>
            <td><%= entrada.tel_responsavel_1 || '' %></td>
            <td><%= entrada.tel_responsavel_2 || '' %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>

                <button class="btn btn-info no-print" onClick="window.print()">Imprimir Lista</button>
            </div>
            <script>
    const filtroInput = document.getElementById('searchInput');
    const tabela = document.getElementById('tabela-entradas');
    const linhas = tabela?.getElementsByTagName('tbody')[0].getElementsByTagName('tr');

    if (filtroInput) {
      filtroInput.addEventListener('input', () => {
        const termo = filtroInput.value.toLowerCase();
        for (let linha of linhas) {
          const nome = linha.cells[0].textContent.toLowerCase();
          const ra = linha.cells[1].textContent.toLowerCase();
          linha.style.display = (nome.includes(termo) || ra.includes(termo)) ? '' : 'none';
        }
      });
    }
  </script>

<script>
  // Exibe o botão quando rolar a página
  window.onscroll = function() { scrollFunction() };

  function scrollFunction() {
    const btn = document.getElementById("btnTopo");
    if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
      btn.style.display = "flex";
    } else {
      btn.style.display = "none";
    }
  }

  // Voltar suavemente ao topo
  function voltarAoTopo() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
</script>

 <!-- Botão flutuante -->
<button onclick="voltarAoTopo()" id="btnTopo" class="btn btn-primary rounded-circle shadow">
  <i class="bi bi-arrow-up"></i>
</button>
</body>
</html>